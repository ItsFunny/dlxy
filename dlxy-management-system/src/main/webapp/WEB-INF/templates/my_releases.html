<#include "wrapper-up.html">
<section class="layui-larry-box">
	<div class="larry-personal">
	    <div class="layui-tab">
            <blockquote class="layui-elem-quote news_search">
		
		<div class="layui-inline">
		    <div class="layui-input-inline">
		    	<input value="" placeholder="请输入关键字" class="layui-input search_input" type="text" id="searchText">
		    </div>
		    <input type="button" id="searchButton" value="查询" class="layui-btn search_btn">
		</div>
		

		<div class="layui-inline">
			<a class="layui-btn layui-btn-danger batchDel" href="/user/releases.html">显示所有</a>
		</div>
		<div class="layui-inline">
			<a class="layui-btn layui-btn-danger batchDel" href="javascript:void(0);" onclick="document.pageForm.pageNum=1;document.pageForm.articleStatus.value=2;document.pageForm.submit();">显示暂时删除的文章</a>
		</div>
		<div class="layui-inline">
			<a class="layui-btn layui-btn-danger batchDel" href="javascript:void(0);" onclick="document.pageForm.pageNum=1;document.pageForm.articleStatus.value=0;document.pageForm.submit();">显示下线的文章</a>
		</div>
		<div class="layui-inline">
			注意,已经删除的文章,当超过删除时间10天之后将会自动删除,不可恢复
		</div>
	</blockquote>
            
		         <!-- 操作日志 -->
                <div class="layui-form news_list">
                    <table class="layui-table">
					    <colgroup>
						<col width="50">
						<col>
						<col width="9%">
						<col width="9%">
						<col width="9%">
						<col width="9%">
						<col width="9%">
						<col width="15%">
					</colgroup>
					<thead>
						<tr>
							<th><input name="" lay-skin="primary" lay-filter="allChoose" id="allChoose" type="checkbox">
								<div class="layui-unselect layui-form-checkbox" lay-skin="primary"><i class="layui-icon"></i></div>
							</th>
							<th>文章ID</th>
							<th style="text-align:left;">文章标题</th>
							<th>作者 </th>
							<th>发布时间</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody class="news_content" id="dataDetail">
					<#if pageVO.data??>
						<#list pageVO.data as item >
						<tr>
							<td><input name="checked" lay-skin="primary" lay-filter="choose" type="checkbox">
								<div class="layui-unselect layui-form-checkbox" lay-skin="primary"><i class="layui-icon"></i></div>
							</td>
							<td>${item.article_id ?c}</td>
							<td align="left">${item.article_name}</td>
							<td>${item.article_author}</td>
							<td>${item.create_date?string('yyyy-MM-dd HH:mm:ss')}</td>
							<td>
								<a class="layui-btn layui-btn-mini news_edit"><i class="iconfont icon-edit"></i> 恢复</a>
								<a class="layui-btn layui-btn-danger layui-btn-mini news_del" data-id="1"><i class="layui-icon"></i> 彻底删除</a>
							</td>
						</tr>
						</#list>
					</#if>
					</tbody>
					</table>
                     <div class="larry-table-page clearfix">
                          <a href="javascript:;" class="layui-btn layui-btn-small"><i class="iconfont icon-shanchu1"></i>彻底删除</a>
						<#if pageVO??>
					      <form name="pageForm" action="/user/releases.html" method="get">
						      	<input type="hidden" name="pageNum" value="${pageVO.pageNum}">
						      	<input type="hidden" name="q" value="${q!""}">
						      	<input type="hidden" name="articleStatus" value="${articleStatus!""}">
						      	<input type="hidden" name="userId" value="${userId!""}">
						      	<div id="page2" class="page">
									<div class="layui-box layui-laypage layui-laypage-default" id="layui-laypage-0">
										<span class="layui-laypage-curr">
							      			<em class="layui-laypage-em"></em>
							      			<em>当前第 ${pageVO.pageNum}页 总共有${pageVO.maxPage}页,总计${pageVO.totalCount}条记录 </em>
						      			</span>
										<#if pageVO.pageNum==1><a href="javascript:void(0)">首页</a>	<#else><a href="javascript:void(0)" onclick="document.pageForm.pageNum.value=1;document.pageForm.submit();">首页</a>   </#if>
										<#if pageVO.pageNum<=1> <a href="javascript:void(0)">上一页</a><#else><a href="javascript:void(0)" onclick="document.pageForm.pageNum.value=(${pageVO.pageNum}-1);document.pageForm.submit();"> 上一页</a>  </#if>
										<#if (pageVO.pageNum>=pageVO.maxPage)> <a href="javascript:void(0)">下一页</a>  <#else><a href="javascript:void(0)" onclick="document.pageForm.pageNum.value=${pageVO.pageNum}+1;document.pageForm.submit();">下一页</a> </#if>		
										<#if (pageVO.pageNum>=pageVO.maxPage)> <a href="javascript:void(0)">最后一页</a> <#else> <a href="javascript:void(0)" onclick="document.pageForm.pageNum.value=${pageVO.maxPage};document.pageForm.submit();">最后一页</a> </#if>>
									</div>				          
						      </div>
					      </form>
			 			</#if>
			         </div>
			    </div>
			     <!-- 登录日志 -->
		    </div>
		</div>
	
</section>
<script type="text/javascript" src="common/layui/layui.js"></script>
<script type="text/javascript" src="js/newslist.js"></script>
<script type="text/javascript">
	$("#searchButton").click(function(){
		var q=$("#searchText").val();
		var userId=$("input[name=userId]").val();
		jQuery.get('/api/search/article.html',{"q":q,"userId":userId},function(data,textStatus,jqXHR){
				var obj=$("#dataDetail");
			if(data.code==1){
				alert(data.data.data.length);
				if(data.data.data.length<1){
				
				}else{
				obj.empty();
				for(var i=0;i<data.data.data.length;i++){
					var d=data.data.data[i];
					obj.append('<tr><td><input name="checked" lay-skin="primary" lay-filter="choose" type="checkbox"><div class="layui-unselect layui-form-checkbox" lay-skin="primary"><i class="layui-icon"></i></div></td><td>'+d.articleId+'</td><td align="left">'+d.articleName+'</td><td>'+d.articleAuthor+'</td><td>'+d.createDate+'</td><td><a class="layui-btn layui-btn-mini news_edit"><i class="iconfont icon-edit"></i> 恢复</a><a class="layui-btn layui-btn-danger layui-btn-mini news_del" data-id="1"><i class="layui-icon"></i> 彻底删除</a></td></tr>')
					}
					var pageVO=data.data;
					var page=$("#layui-laypage-0");
					page.empty();
					page.append('<span class="layui-laypage-curr"><em class="layui-laypage-em"></em><em>当前第 '+pageVO.pageNum+'页 总共有'+pageVO.maxPage+'页,总计'+pageVO.totalCount+'条记录 </em></span>')
					var str="";
					if(pageVO.pageNum<=1){
						str+='<a href="javascript:void(0);">首页</a>';
						str+='<a href="javascript:void(0);">上一页</a>';
					}else{
						str='<a href="javascript:void(0);" onclick="document.pageForm.pageNum.value=1;document.pageForm.submit()"';
						str+='<a href="javscript:void(0);" onclick="document.pageForm.pageNum.value='+(pageVO.pageNum-1)+';document.pageForm.submit();"';
					}
					if(pageVO.pageNum>=pageVO.maxPage){
						str+='<a href="javascript:void(0);">下一页</a>'	
						str+='<a href="javascript:void(0);">最后一页</a>'
					}else{
						str+='<a href="javascript:void(0);" onclick="document.pageForm.pageNum.value='+(pageVO.pageNum+1)+';document.pageForm.submit()">下一页</a>'
						str+='<a href="javascript:void(0)" onclick="document.pageForm.pageNum.value='+(pageVO.maxPage)+';document.pageForm.submit();">最后一页</a>'
					}
					page.append(str);
				}
			}else{
				alert(data.msg);
			}			
		},'json');
	});
</script>
<#include "wrapper-down.html">